

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>fpgaotsu &mdash; OPAE</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="OPAE" href="../../../index.html"/>
        <link rel="next" title="super-rsu" href="../super-rsu/super-rsu.html"/>
        <link rel="prev" title="fpgasupdate" href="../fpgasupdate/fpgasupdate.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> OPAE
          

          
          </a>

          
            
            
              <div class="version">
                1.1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">OPAE User Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../fpga_api/quick_start/readme.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install_guide/installation_guide.html">OPAE Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fpga_api/prog_guide/readme.html">OPAE C API Programming Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ase_userguide/ase_userguide.html">Intel® Accelerator Functional Unit (AFU) Simulation Environment (ASE) User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../README.html">OPAE Python Bindings</a></li>
</ul>
<p class="caption"><span class="caption-text">OPAE Libraries</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../build_chain/fpga_api/api_build.html">Building the OPAE C Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fpga_api/fpga_api.html">OPAE C API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fpga_api/fpga_cxx_api.html">OPAE C++ Core API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fpga_api/fpga_python_api.html">OPAE Python API Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">OPAE Linux Kernel Drivers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../drv_arch/drv_arch.html">Open Programmable Accelerator Engine (OPAE) Linux Device Driver Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../drv_arch/drv_arch.html#sysfs-files">sysfs files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../build_chain/fpga_driver/driver_build.html">Building the OPAE Intel FPGA driver (in-tree)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../build_chain/fpga_driver/driver_build.html#building-the-opae-intel-fpga-driver-out-of-tree">Building the OPAE Intel FPGA driver (out-of-tree)</a></li>
</ul>
<p class="caption"><span class="caption-text">OPAE FPGA Tools</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../coreidle/coreidle.html">coreidle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpgabist/fpgabist.html">fpgabist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpgainfo/fpgainfo.html">fpgainfo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpgaconf/fpgaconf.html">fpgaconf</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpgad/fpgad.html">fpgad</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpgadiag/README.html">fpgadiag</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpgaflash/fpgaflash.html">fpgaflash</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpgamux/fpgamux.html">fpgamux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpgaport/fpgaport.html">fpgaport</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mmlink/mmlink.html">mmlink</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pacd/pacd.html">pacd</a></li>
<li class="toctree-l1"><a class="reference internal" href="../packager/packager.html">packager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userclk/userclk.html">userclk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PACSign/PACSign.html">PACSign</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpgasupdate/fpgasupdate.html">fpgasupdate</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">fpgaotsu</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#synopsis">SYNOPSIS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#description">DESCRIPTION</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#positional-arguments">POSITIONAL ARGUMENTS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optional-arguments">OPTIONAL ARGUMENTS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example">EXAMPLE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fpga-d5005-card">FPGA D5005 card:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fpga-n3000-card">FPGA N3000 card:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#testing-steps">Testing steps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#one-time-update-install-steps">one-time update install steps:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#one-time-update-tool-input-specs">one-time update tool input specs:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fpgaotsu-n3000-json">fpgaotsu_n3000.json:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fpgaotsu-d5005-json">fpgaotsu_d5005.json:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../super-rsu/super-rsu.html">super-rsu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bitstream_info/bitstream_info.html">bitstreaminfo</a></li>
</ul>
<p class="caption"><span class="caption-text">OPAE AFU Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hssi_config/readme.html">hssi_config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hssi_loopback/readme.html">hssi_loopback</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">OPAE</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Docs</a> &raquo;</li>
      
    <li>fpgaotsu</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/docs/fpga_tools/fpgaotsu/fpgaotsu.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="fpgaotsu">
<h1>fpgaotsu<a class="headerlink" href="#fpgaotsu" title="Permalink to this headline">¶</a></h1>
<div class="section" id="synopsis">
<h2>SYNOPSIS<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">fpgaotsu.py</span> <span class="pre">[-h]</span> <span class="pre">[--rsu-only]</span> <span class="pre">[--rsu]</span> <span class="pre">[-v]</span> <span class="pre">fpgaotsu_json</span></code></p>
</div>
<div class="section" id="description">
<h2>DESCRIPTION<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>One-time update tool updates non Root of Trust PCIe FPGA cards to Root
of Trust (RoT) PCIe FPGA cards. Tool updates NIOS factory, NIOS user,
BMC root key hash, SR key hash, MAX10 device tree, FPGA factory image,
FPGA user, NIOS boot loader, MAX10 factory and MAX10 user to Root of
Trust firmware.</p>
<div class="section" id="positional-arguments">
<h3>POSITIONAL ARGUMENTS<a class="headerlink" href="#positional-arguments" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">{fpgaotsu_json}</span></code></p>
<p>Specifies the input json file or manifest.</p>
</div>
<div class="section" id="optional-arguments">
<h3>OPTIONAL ARGUMENTS<a class="headerlink" href="#optional-arguments" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">-h,</span> <span class="pre">--help</span></code></p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="n">Print</span> <span class="n">usage</span> <span class="n">information</span><span class="p">.</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">--rsu-only</span></code></p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="n">Reset</span> <span class="n">fpga</span> <span class="n">pcie</span> <span class="n">card</span> <span class="n">and</span> <span class="n">loads</span> <span class="n">updated</span> <span class="n">firmware</span><span class="p">.</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">--rsu</span></code></p>
<div class="highlight-c"><div class="highlight"><pre><span></span>Updates fpga with Root of Trust firmware and Reset fpga pcie card.

`-v --verbose`

Enables debug logging.
</pre></div>
</div>
</div>
<div class="section" id="example">
<h3>EXAMPLE<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">fpgaotsu.py</span> <span class="pre">/usr/share/opae/d5005/one-time-update/fpgaotsu_d5005.json</span></code></p>
<p>Programs all FPGA D5005 cards with Root of Trust firmware.</p>
<p><code class="docutils literal"><span class="pre">fpgaotsu.py</span> <span class="pre">/usr/share/opae/n3000/one-time-update/fpgaotsu_d3000.json</span></code></p>
<p>Programs all FPGA N3000 cards with Root of Trust firmware.</p>
<div class="section" id="fpga-d5005-card">
<h4>FPGA D5005 card:<a class="headerlink" href="#fpga-d5005-card" title="Permalink to this headline">¶</a></h4>
<p>User has to power cycle system after updating Root of Trust with
one-time update tool.</p>
</div>
<div class="section" id="fpga-n3000-card">
<h4>FPGA N3000 card:<a class="headerlink" href="#fpga-n3000-card" title="Permalink to this headline">¶</a></h4>
<p>One-time update tool reset fpga pcie card two times after updating RoT
firmware, Boot to Max10 factory image after first reset and boot to FPGA
factory image after second reset. No need to power cycle system, fpga
card reset loads to Root of Trust firmware.</p>
</div>
</div>
</div>
<div class="section" id="testing-steps">
<h2>Testing steps<a class="headerlink" href="#testing-steps" title="Permalink to this headline">¶</a></h2>
<div class="section" id="one-time-update-install-steps">
<h3>one-time update install steps:<a class="headerlink" href="#one-time-update-install-steps" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c"><div class="highlight"><pre><span></span>1. Install from opae-one-time-update.rpm
   This should install dependencies:
   * opae-intel-fpga-driver
   * opae-tools-extra
   * Security-Tools
2. Verify one-time update files (firmware and manifest) installed in
   * /usr/share/opae/n3000/one-time-update
   * /usr/share/opae/d5005/one-time-update

3. Update FPGA N3000 card with temporary max10 image to access second flash.
   1. sudo fpgaflash bmc_img usr/share/opae/n3000/one-time-update/max10_system_revd_dual_v111.1.13_temporary_cfm0_auto.rpd --rsu
   2. Verify sysfs attributes /sys/class/fpga/intel-fpga-dev.*/intel-fpga-fme.*/spi-altera.*.auto/spi_master/spi*/spi*.*/intel-generic-qspi.*.auto

4. Run &quot;fpgaotsu.py /usr/share/opae/n3000/one-time-update/fpgaotsu_n3000.json&quot; for intel fpga N3000 card or
   Run &quot;fpgaotsu.py /usr/share/opae/d5005/one-time-update/fpgaotsu_d5005.json&quot; for intel fpga D5005 card
   * Updates Nios, MAX10 and FPGA images for FPGA N3000 and D5005.
   * User has to power cycle FPGA D5005 card system after updating Root of Trust firmware.
</pre></div>
</div>
</div>
<div class="section" id="one-time-update-tool-input-specs">
<h3>one-time update tool input specs:<a class="headerlink" href="#one-time-update-tool-input-specs" title="Permalink to this headline">¶</a></h3>
<div class="section" id="fpgaotsu-n3000-json">
<h4>fpgaotsu_n3000.json:<a class="headerlink" href="#fpgaotsu-n3000-json" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="fpgaotsu-d5005-json">
<h4>fpgaotsu_d5005.json:<a class="headerlink" href="#fpgaotsu-d5005-json" title="Permalink to this headline">¶</a></h4>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../super-rsu/super-rsu.html" class="btn btn-neutral float-right" title="super-rsu" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../fpgasupdate/fpgasupdate.html" class="btn btn-neutral" title="fpgasupdate" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017 Intel Corporation.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1.1.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>