

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>hssi_config &mdash; OPAE</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="hssi_loopback" href="../hssi_loopback/readme.html" />
    <link rel="prev" title="userclk" href="../userclk/userclk.html" /> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> OPAE
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">OPAE User Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../fpga_api/quick_start/readme.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install_guide/installation_guide.html">OPAE Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install_guide/installation_guide.html#opae-sdk-installation-with-rpm-packages">OPAE SDK installation with rpm packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fpga_api/prog_guide/readme.html">OPAE C API Programming Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ase_userguide/ase_userguide.html">OPAE AFU Simulation Environment (ASE) User Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">OPAE Libraries</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../build_chain/fpga_api/api_build.html">Building the OPAE C Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fpga_api/fpga_api.html">OPAE C API Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">OPAE Linux Kernel Drivers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../drv_arch/drv_arch.html">OPAE Intel® FPGA Linux Device Driver Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../drv_arch/drv_arch.html#sysfs-files">sysfs files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../build_chain/fpga_driver/driver_build.html">Building the OPAE Intel FPGA driver (in-tree)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../build_chain/fpga_driver/driver_build.html#building-the-opae-intel-fpga-driver-out-of-tree">Building the OPAE Intel FPGA driver (out-of-tree)</a></li>
</ul>
<p class="caption"><span class="caption-text">OPAE FPGA Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../coreidle/coreidle.html">coreidle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpgabist/fpgabist.html">fpgabist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpgainfo/fpgainfo.html">fpgainfo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpgaconf/fpgaconf.html">fpgaconf</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpgad/fpgad.html">fpgad</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpgadiag/README.html">fpgadiag</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpgaflash/fpgaflash.html">fpgaflash</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpgamux/fpgamux.html">fpgamux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpgaport/fpgaport.html">fpgaport</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mmlink/mmlink.html">mmlink</a></li>
<li class="toctree-l1"><a class="reference internal" href="../packager/packager.html">packager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userclk/userclk.html">userclk</a></li>
</ul>
<p class="caption"><span class="caption-text">OPAE AFU Tools</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">hssi_config</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#synopsis">Synopsis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#options">Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#commands">Commands</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#locating-the-fme-device">Locating the FME device</a></li>
<li class="toctree-l2"><a class="reference internal" href="#csv-file-format">CSV file format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples-of-commands">Examples of commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dumping-registers">Dumping registers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#reading-single-registers">Reading single registers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#loading-registers">Loading registers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#writing-single-registers">Writing single registers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#testing-hssi-read-and-write">Testing HSSI read and write</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hssi_loopback/readme.html">hssi_loopback</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">OPAE</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
      <li>hssi_config</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/docs/fpga_tools/hssi_config/readme.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="hssi-config">
<h1>hssi_config<a class="headerlink" href="#hssi-config" title="Permalink to this headline">¶</a></h1>
<div class="section" id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h2>
<p>hssi_config reads or writes HSSI registers on either on an Intel FPGA
using the FPGA Interface Manager (FIM) or on an HSSI retimer card
attached to the board. hssi_config is only available for the Integrated
FPGA Platform. You cannot run it on the PCIe accelerator card (PAC).</p>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">hssi_config</span> <span class="pre">[--resource|-r</span> <span class="pre">&lt;sysfs</span> <span class="pre">resource&gt;]</span> <span class="pre">[--socket-id|s</span> <span class="pre">0|1]</span> <span class="pre">command</span> <span class="pre">[command</span> <span class="pre">options]</span></code></p>
<p>Where command is one of the following:</p>
<div class="code sh highlight-c"><div class="highlight"><pre><span></span><span class="n">dump</span> <span class="p">[</span><span class="n">outfile</span><span class="p">.</span><span class="n">csv</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">input</span><span class="o">-</span><span class="n">file</span> <span class="n">inputfile</span><span class="p">.</span><span class="n">csv</span><span class="p">]</span>
<span class="n">iread</span> <span class="n">instance</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="n">device</span><span class="o">-</span><span class="n">addr</span> <span class="n">byte</span><span class="o">-</span><span class="n">address</span> <span class="n">byte</span><span class="o">-</span><span class="n">count</span>
<span class="n">iwrite</span> <span class="n">instance</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="n">device</span><span class="o">-</span><span class="n">addr</span> <span class="n">byte</span><span class="o">-</span><span class="n">address</span> <span class="n">byte1</span> <span class="p">[</span><span class="n">byte2</span> <span class="p">[</span><span class="n">byte3</span><span class="p">...]]</span>
<span class="n">load</span> <span class="p">[</span><span class="n">inputfile</span><span class="p">.</span><span class="n">csv</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">c</span><span class="o">-</span><span class="n">header</span><span class="p">]</span>
<span class="n">read</span> <span class="n">lane</span><span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="mi">15</span><span class="p">)</span> <span class="n">reg</span><span class="o">-</span><span class="n">address</span>
<span class="n">rread</span> <span class="n">device</span><span class="p">(</span><span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">)</span> <span class="n">channel</span><span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="n">address</span>
<span class="n">rwrite</span> <span class="n">device</span><span class="p">(</span><span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">)</span> <span class="n">channel</span><span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="n">address</span> <span class="n">value</span>
<span class="n">test</span> <span class="p">(</span><span class="n">rd</span><span class="o">|</span><span class="n">rw</span><span class="p">)</span> <span class="n">inputfile</span><span class="p">.</span><span class="n">csv</span> <span class="p">[</span><span class="o">--</span><span class="n">acktimes</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">repeat</span> <span class="n">N</span><span class="p">]</span>
<span class="n">write</span> <span class="n">lane</span><span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="mi">15</span><span class="p">)</span> <span class="n">reg</span><span class="o">-</span><span class="n">address</span> <span class="n">value</span>
</pre></div>
</div>
<p>The first argument is the command and any additional arguments are
command arguments. The following options and commands are available:</p>
<div class="section" id="options">
<h3>Options<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">[--resource|-r</span> <span class="pre">&lt;sysfs</span> <span class="pre">resource</span> <span class="pre">path&gt;</span></code></p>
<div class="highlight-c"><div class="highlight"><pre><span></span>The resource path in the sysfs psuedo-filesystem.
Example:
`/sys/devices/pci0000\:5e/0000\:5e\:00.0/resource0`
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">[--socket-id</span> <span class="pre">0|1]</span></code></p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">socket</span> <span class="n">id</span> <span class="n">of</span> <span class="n">the</span> <span class="n">target</span> <span class="n">FPGA</span><span class="p">.</span>
<span class="n">Required</span> <span class="n">on</span> <span class="n">two</span><span class="o">-</span><span class="n">socket</span> <span class="n">systems</span> <span class="n">to</span> <span class="n">differentiate</span> <span class="n">between</span> <span class="n">the</span> <span class="n">two</span> <span class="n">possible</span> <span class="n">target</span> <span class="n">FPGAs</span><span class="p">.</span>
</pre></div>
</div>
</div>
<div class="section" id="commands">
<h3>Commands<a class="headerlink" href="#commands" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">dump</span> <span class="pre">[outfile.csv]</span> <span class="pre">[--input-file</span> <span class="pre">inputfile.csv]</span></code></p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="n">Dump</span> <span class="n">registers</span> <span class="n">to</span> <span class="n">stdout</span> <span class="n">or</span> <span class="n">to</span> <span class="n">a</span> <span class="n">file</span><span class="p">,</span> <span class="k">if</span> <span class="n">provided</span><span class="p">.</span> <span class="n">hssi_config</span> <span class="n">has</span> <span class="n">a</span> <span class="n">built</span><span class="o">-</span><span class="n">in</span> <span class="n">set</span> <span class="n">of</span> <span class="n">registers</span> <span class="n">to</span>
<span class="n">dump</span><span class="p">.</span> <span class="n">The</span> <span class="n">first</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">the</span> <span class="n">path</span> <span class="n">to</span> <span class="n">a</span> <span class="n">file</span> <span class="n">to</span> <span class="n">write</span><span class="p">.</span> <span class="n">The</span> <span class="n">command</span> <span class="n">dumps</span> <span class="n">to</span> <span class="n">stdout</span> <span class="k">if</span> <span class="n">you</span> <span class="k">do</span> <span class="n">not</span>
<span class="n">specify</span> <span class="n">a</span> <span class="n">file</span> <span class="n">name</span><span class="p">.</span> <span class="n">Use</span> <span class="n">the</span> <span class="o">--</span><span class="n">input</span><span class="o">-</span><span class="n">file</span> <span class="n">option</span> <span class="n">to</span> <span class="n">specify</span> <span class="n">a</span> <span class="n">different</span> <span class="n">set</span> <span class="n">of</span> <span class="n">registers</span><span class="p">.</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">load</span> <span class="pre">[inputfile.csv]</span> <span class="pre">[--c-header]</span></code></p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="n">Load</span> <span class="n">a</span> <span class="n">set</span> <span class="n">of</span> <span class="k">register</span> <span class="n">values</span> <span class="n">from</span> <span class="n">either</span> <span class="n">stdin</span> <span class="n">or</span> <span class="n">an</span> <span class="n">input</span> <span class="n">file</span> <span class="k">if</span> <span class="n">provided</span><span class="p">.</span> <span class="n">The</span> <span class="n">first</span> <span class="n">argument</span>
<span class="n">is</span> <span class="n">the</span> <span class="n">path</span> <span class="n">to</span> <span class="n">a</span> <span class="n">file</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">registers</span> <span class="n">to</span> <span class="n">load</span><span class="p">.</span> <span class="n">Loads</span> <span class="n">from</span> <span class="n">stdin</span> <span class="k">if</span> <span class="n">omitted</span><span class="p">.</span>

<span class="n">Use</span> <span class="o">--</span><span class="n">c</span><span class="o">-</span><span class="n">header</span> <span class="n">to</span> <span class="n">generate</span> <span class="n">a</span> <span class="n">C</span> <span class="n">header</span> <span class="n">file</span> <span class="n">with</span> <span class="n">an</span> <span class="n">array</span> <span class="n">of</span> <span class="mi">64</span><span class="o">-</span><span class="n">bit</span> <span class="n">numbers</span> <span class="n">to</span> <span class="n">write</span> <span class="n">to</span> <span class="n">the</span> <span class="n">HSSI_CTRL</span> <span class="k">register</span><span class="p">.</span>
<span class="n">This</span> <span class="n">header</span> <span class="n">file</span> <span class="n">can</span> <span class="n">substitute</span> <span class="k">for</span> <span class="n">the</span> <span class="n">input</span> <span class="n">file</span><span class="p">.</span>
<span class="nl">NOTE</span><span class="p">:</span> <span class="n">You</span> <span class="n">must</span> <span class="n">perform</span> <span class="n">the</span> <span class="n">acknowledge</span> <span class="n">routine</span> <span class="n">after</span> <span class="n">each</span> <span class="n">write</span><span class="p">.</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">read</span> <span class="pre">lane(0-15)</span> <span class="pre">reg-address</span></code></p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="n">Read</span> <span class="n">from</span> <span class="n">a</span> <span class="n">single</span> <span class="n">XCVR</span> <span class="p">(</span><span class="n">transceiver</span><span class="p">)</span> <span class="k">register</span><span class="p">.</span>
<span class="n">The</span> <span class="n">first</span> <span class="n">command</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">the</span> <span class="n">XCVR</span> <span class="n">lane</span><span class="p">.</span> <span class="n">Use</span> <span class="o">-</span><span class="mi">1</span> <span class="n">to</span> <span class="n">specify</span> <span class="n">a</span> <span class="n">read</span> <span class="n">from</span> <span class="n">all</span> <span class="n">lanes</span><span class="p">.</span>
<span class="n">The</span> <span class="n">second</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">the</span> <span class="n">XCVR</span> <span class="n">address</span> <span class="p">(</span><span class="n">offset</span><span class="p">).</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">write</span> <span class="pre">lane(0-15)</span> <span class="pre">reg-address</span> <span class="pre">value</span></code></p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="n">Write</span> <span class="n">to</span> <span class="n">a</span> <span class="n">single</span> <span class="n">XCVR</span> <span class="k">register</span><span class="p">.</span>
<span class="n">The</span> <span class="n">first</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">the</span> <span class="n">XCVR</span> <span class="n">lane</span><span class="p">.</span>
<span class="n">The</span> <span class="n">second</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">the</span> <span class="n">XCVR</span> <span class="n">address</span><span class="p">(</span><span class="n">offset</span><span class="p">).</span>
<span class="n">The</span> <span class="n">third</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">the</span> <span class="n">value</span> <span class="n">to</span> <span class="n">write</span> <span class="n">to</span> <span class="n">the</span> <span class="k">register</span><span class="p">.</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">rread</span> <span class="pre">device(0x30,</span> <span class="pre">0x32,</span> <span class="pre">0x34,</span> <span class="pre">0x36)</span> <span class="pre">channel(0-3)</span> <span class="pre">address</span></code></p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="n">Read</span> <span class="n">from</span> <span class="n">a</span> <span class="n">single</span> <span class="n">retimer</span> <span class="k">register</span><span class="p">.</span>
<span class="n">The</span> <span class="n">first</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">the</span> <span class="n">I2C</span> <span class="n">device</span> <span class="n">address</span><span class="p">.</span>
<span class="n">The</span> <span class="n">second</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">the</span> <span class="n">channel</span><span class="p">.</span>
<span class="n">The</span> <span class="n">third</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">the</span> <span class="k">register</span> <span class="n">address</span> <span class="p">(</span><span class="n">or</span> <span class="n">I2C</span> <span class="n">byte</span> <span class="n">address</span><span class="p">).</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">rwrite</span> <span class="pre">device(0x30,</span> <span class="pre">0x32,</span> <span class="pre">0x34,</span> <span class="pre">0x36)</span> <span class="pre">channel(0-3)</span> <span class="pre">address</span> <span class="pre">value</span></code></p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="n">Write</span> <span class="n">to</span> <span class="n">a</span> <span class="n">single</span> <span class="n">retimer</span> <span class="k">register</span><span class="p">.</span>
<span class="n">The</span> <span class="n">first</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">the</span> <span class="n">I2C</span> <span class="n">device</span> <span class="n">address</span><span class="p">.</span>
<span class="n">The</span> <span class="n">second</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">the</span> <span class="n">channel</span><span class="p">.</span>
<span class="n">The</span> <span class="n">third</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">the</span> <span class="k">register</span> <span class="n">address</span> <span class="p">(</span><span class="n">or</span> <span class="n">I2C</span> <span class="n">byte</span> <span class="n">address</span><span class="p">).</span>
<span class="n">The</span> <span class="n">fourth</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">the</span> <span class="n">value</span> <span class="n">to</span> <span class="n">write</span><span class="p">.</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">iread</span> <span class="pre">instance</span> <span class="pre">(0,1)</span> <span class="pre">device-addr</span> <span class="pre">byte-address</span> <span class="pre">byte-count</span></code></p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="n">Read</span> <span class="n">from</span> <span class="n">a</span> <span class="n">device</span> <span class="n">on</span> <span class="n">the</span> <span class="n">I2C</span> <span class="n">bus</span><span class="p">.</span>
<span class="n">The</span> <span class="n">first</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">the</span> <span class="n">I2C</span> <span class="n">controller</span> <span class="n">instance</span> <span class="p">(</span><span class="mi">0</span> <span class="n">or</span> <span class="mi">1</span><span class="p">).</span>
<span class="n">The</span> <span class="n">second</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">the</span> <span class="n">device</span> <span class="n">address</span> <span class="n">to</span> <span class="n">read</span> <span class="n">from</span><span class="p">.</span>
<span class="n">The</span> <span class="n">third</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">the</span> <span class="n">byte</span> <span class="n">address</span> <span class="n">of</span> <span class="n">the</span> <span class="k">register</span> <span class="n">to</span> <span class="n">read</span> <span class="n">from</span> <span class="n">the</span> <span class="n">device</span><span class="p">.</span>
<span class="n">The</span> <span class="n">fourth</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">bytes</span> <span class="n">to</span> <span class="n">read</span><span class="p">.</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">iwrite</span> <span class="pre">instance</span> <span class="pre">(0,1)</span> <span class="pre">device-addr</span> <span class="pre">byte-address</span> <span class="pre">byte1</span> <span class="pre">[byte2</span> <span class="pre">[byte3...]]</span></code></p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="n">Write</span> <span class="n">to</span> <span class="n">a</span> <span class="n">device</span> <span class="n">on</span> <span class="n">the</span> <span class="n">I2C</span> <span class="n">bus</span><span class="p">.</span>
<span class="n">The</span> <span class="n">first</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">the</span> <span class="n">I2C</span> <span class="n">controller</span> <span class="n">instance</span> <span class="p">(</span><span class="mi">0</span> <span class="n">or</span> <span class="mi">1</span><span class="p">).</span>
<span class="n">The</span> <span class="n">second</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">the</span> <span class="n">device</span> <span class="n">address</span> <span class="n">to</span> <span class="n">read</span> <span class="n">from</span><span class="p">.</span>
<span class="n">The</span> <span class="n">third</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">the</span> <span class="n">byte</span> <span class="n">address</span> <span class="n">of</span> <span class="n">the</span> <span class="k">register</span> <span class="n">to</span> <span class="n">read</span> <span class="n">from</span> <span class="n">the</span> <span class="n">device</span><span class="p">.</span>
<span class="n">All</span> <span class="n">subsequent</span> <span class="n">arguments</span> <span class="n">are</span> <span class="n">the</span> <span class="n">bytes</span> <span class="n">to</span> <span class="n">write</span> <span class="n">to</span> <span class="n">the</span> <span class="n">device</span><span class="p">.</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">test</span> <span class="pre">(rd|rw)</span> <span class="pre">inputfile.csv</span> <span class="pre">[--acktimes]</span></code></p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="n">Perform</span> <span class="n">built</span><span class="o">-</span><span class="n">in</span> <span class="n">test</span> <span class="k">for</span> <span class="n">reading</span> <span class="n">or</span> <span class="n">writing</span> <span class="n">XCVR</span> <span class="n">registers</span><span class="p">.</span>
<span class="n">The</span> <span class="n">first</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">the</span> <span class="n">path</span> <span class="n">to</span> <span class="n">a</span> <span class="n">file</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">registers</span> <span class="n">to</span> <span class="n">test</span><span class="p">.</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>hssi_config is a utility that reads or writes hssi equalization
parameters stored in either the tranceiver (XCVR) registers or the
registers of the retimer on the I2C bus. To access registers, the hssi
controller writes to the HSSI_CTRL register and reads from the HSSI_STAT
register in the the FME (FPGA Management Engine). These two registers
implement the HSSI AUX bus mailbox protocol to access devices on other
buses. Because hssi_config maps the FME MMIO space directly, the FPGA
driver is not required.</p>
</div>
<div class="section" id="locating-the-fme-device">
<h2>Locating the FME device<a class="headerlink" href="#locating-the-fme-device" title="Permalink to this headline">¶</a></h2>
<p>The FME (FPGA Management Engine) reads and writes the HSSI_CTRL and
HSSI_STAT registers on the NIOS device. The FME maps the MMIO address
space of the FME identified by its resource in the sysfs
psuedo-filesystem in Linux operating systems. To identify resource
paths, use the lspci utility to query for Intel devices with device id
of bcc0.</p>
<p>Example:</p>
<p><code class="docutils literal"><span class="pre">lspci</span> <span class="pre">-d</span> <span class="pre">8086:bcc0</span></code></p>
<p>This command should print out at least one line like the following
example:</p>
<p><code class="docutils literal"><span class="pre">5e:00.0</span> <span class="pre">Processing</span> <span class="pre">accelerators:</span> <span class="pre">Intel</span> <span class="pre">Corporation</span> <span class="pre">Device</span> <span class="pre">bcc0</span></code></p>
<p>Use the first three numbers (bus:device.function) to locate the device
resource in the sysfs filesystem:</p>
<p><code class="docutils literal"><span class="pre">/sys/devices/pci0000\:&lt;bus&gt;/0000\:&lt;bus&gt;\:&lt;device&gt;.&lt;function&gt;/resource0</span></code></p>
<p>For example, the example above with bus of 5e, device of 00 and function
of 0 would use a resource path as follows:</p>
<p><code class="docutils literal"><span class="pre">/sys/devices/pci0000\:5e/0000\:5e\:00.0/resource0</span></code></p>
</div>
<div class="section" id="csv-file-format">
<h2>CSV file format<a class="headerlink" href="#csv-file-format" title="Permalink to this headline">¶</a></h2>
<p>Any CSV file parsed by hssi_config must meet have at least four columns.
The following table provides the column specifications:</p>
<table border="1" class="docutils">
<colgroup>
<col width="4%" />
<col width="21%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">C
o
l
u
m
n</th>
<th class="head">Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>Register
type.</td>
<td>Can be either FPGA_RX, FPGA_TX, RTMR_RX, RTMR_TX
(or their corresponding numeric values, 1-4).</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>Lane or
Channel</td>
<td>0-15 for XCVR lanes on FPGA, 0-3 for retimer
channels. -1 to designate all lanes or channels.</td>
</tr>
<tr class="row-even"><td>3</td>
<td>Device
address (on
I2C bus)</td>
<td>Only applies to retimer registers. 0 - 3, -1 to
designate all devices.</td>
</tr>
<tr class="row-odd"><td>4</td>
<td>Register
address (or
offset)</td>
<td>Examples: 0x213, 0x100.</td>
</tr>
<tr class="row-even"><td>5</td>
<td>Register
value to
write</td>
<td>Examples: 0x1, 1, 0. Applies only when loading
or writing registers.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="examples-of-commands">
<h2>Examples of commands<a class="headerlink" href="#examples-of-commands" title="Permalink to this headline">¶</a></h2>
<div class="section" id="dumping-registers">
<h3>Dumping registers<a class="headerlink" href="#dumping-registers" title="Permalink to this headline">¶</a></h3>
<p>Dump default register set to stdout:</p>
<p><code class="docutils literal"><span class="pre">&gt;hssi_config</span> <span class="pre">dump</span></code></p>
<p>Dump default registers to a file, data.csv:</p>
<p><code class="docutils literal"><span class="pre">&gt;hssi_config</span> <span class="pre">dump</span> <span class="pre">data.csv</span></code></p>
<p>Dump to an output file, data.csv, Registers specified in an input file,
regspec.csv:</p>
<p><code class="docutils literal"><span class="pre">&gt;hssi_config</span> <span class="pre">dump</span> <span class="pre">data.csv</span> <span class="pre">--input-file</span> <span class="pre">regspec.csv</span></code></p>
<div class="section" id="reading-single-registers">
<h4>Reading single registers<a class="headerlink" href="#reading-single-registers" title="Permalink to this headline">¶</a></h4>
<p>Read register from XCVR at 0x2e1 on lane 0:</p>
<p><code class="docutils literal"><span class="pre">&gt;hssi_config</span> <span class="pre">read</span> <span class="pre">0</span> <span class="pre">0x2e1</span></code></p>
<p>Read register 0x109 from retimer on channel 0, device 0x30, channel 1:</p>
<p><code class="docutils literal"><span class="pre">&gt;hssi_config</span> <span class="pre">rread</span> <span class="pre">0</span> <span class="pre">0x30</span> <span class="pre">0x109</span></code></p>
</div>
</div>
<div class="section" id="loading-registers">
<h3>Loading registers<a class="headerlink" href="#loading-registers" title="Permalink to this headline">¶</a></h3>
<p>Load registers specified in an input file called data.csv:</p>
<p><code class="docutils literal"><span class="pre">&gt;hssi_config</span> <span class="pre">load</span> <span class="pre">data.csv</span></code></p>
<p>Load registers specified from stdin:</p>
<p><code class="docutils literal"><span class="pre">&gt;hssi_config</span> <span class="pre">load</span></code></p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="n">FPGA_RX</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mh">0x213</span><span class="p">,</span><span class="mi">0</span>
<span class="n">FPGA_RX</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mh">0x213</span><span class="p">,</span><span class="mi">0</span>
<span class="n">FPGA_RX</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mh">0x213</span><span class="p">,</span><span class="mi">0</span>
<span class="o">&lt;</span><span class="n">CTRL</span><span class="o">-</span><span class="n">D</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="section" id="writing-single-registers">
<h4>Writing single registers<a class="headerlink" href="#writing-single-registers" title="Permalink to this headline">¶</a></h4>
<p>Write 1 to XCVR register at 0x2e1 on lane 0:</p>
<p><code class="docutils literal"><span class="pre">&gt;hssi_config</span> <span class="pre">write</span> <span class="pre">0</span> <span class="pre">0x2e1</span> <span class="pre">1</span></code></p>
<p>Read register 0x109 from retimer on channel 0, device 0x30, channel 1:</p>
<p><code class="docutils literal"><span class="pre">&gt;hssi_config</span> <span class="pre">rread</span> <span class="pre">0</span> <span class="pre">0x30</span> <span class="pre">0x109</span></code></p>
</div>
</div>
</div>
<div class="section" id="testing-hssi-read-and-write">
<h2>Testing HSSI read and write<a class="headerlink" href="#testing-hssi-read-and-write" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">test</span></code> command tests read or read and write operations on the XCVR
registers. The first argument to test must be either rd or rw and the
second argument is the path to a file containing the set of registers to
test. The rd command reads all the registers. For rw, every register in
the file is read from and written to in the following sequence: 1. Read
the register, save the value 2. Write 1 to the register 3. Read the
register, verify that the register value is 1 4. Write 0 to the register
5. Read the register, verify that the register value is 0 6. Write the
original value to the register 7. Read the register, assert it is the
original value</p>
<p>The command line option –acktimes indicates that the time spent in the
ack routine should be measured. When meaured, a summary of ack times
will be printed out.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../hssi_loopback/readme.html" class="btn btn-neutral float-right" title="hssi_loopback" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../userclk/userclk.html" class="btn btn-neutral" title="userclk" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017 Intel Corporation.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1.0.0',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>